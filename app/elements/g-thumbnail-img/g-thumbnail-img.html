<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="g-thumbnail-img">
  <template>
    <style>
      :host {
        display: block;
        float: left;
      }
      img {
        margin: 0 auto;
        width: 100%;
        height: 100%;
        object-fit: contain;
        display: block;
      }
    </style>

    <img on-load="_handleLoad" id="picture">

  </template>

  <script>
  (function() {
    'use strict';

    var proxyUrl = 'https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?url=[src]&container=focus&resize_h=[height]&refresh=31536000';

    Polymer({
      is: 'g-thumbnail-img',

      properties: {
        src: {
          type: String,
          notify: true,
          observer: '_updateSrc'
        },
        height: Number
      },

      _handleLoad: function (e) {
        //var img = this.$.picture;

        /*if (img.naturalWidth < img.naturalHeight) {
          img.style.width = 'auto';
          this.style.width = img.clientWidth + 'px';
        } else {
          img.style.height = 'auto';
          this.style.height = img.clientHeight + 'px';
        }*/

        this.fire('load', e);
      },

      _updateSrc: function (src) {
        //var img = this.$.picture;

        // Reset calculations about image dimensions.
        /*this.style.width = '';
        this.style.height = '';
        img.style.width = '100%';
        img.style.height = '100%';*/

        this.$.picture.src = proxyUrl
          .replace('[src]', encodeURIComponent(src))
          .replace('[height]', this.height ||Â '');
      }
    });
  })();
  </script>
</dom-module>
